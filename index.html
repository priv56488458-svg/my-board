<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Інфо-Табло: Новини та Вітання</title>
    <style>
        body { margin: 0; padding: 0; background: #000; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        .slide { display: none; width: 100vw; height: 100vh; animation: fadeIn 1s; }
        .slide.active { display: block; }
        
        /* Слайд 1: Карта */
        iframe { width: 100%; height: 100%; border: none; background: #fff; }

        /* Загальний стиль для текстових слайдів */
        .text-slide { display: flex; flex-direction: column; height: 100vh; padding: 40px; box-sizing: border-box; background: radial-gradient(circle, #1a1a1a 0%, #000 100%); }
        h1 { color: #ff4444; font-size: 4rem; margin: 0 0 20px 0; text-align: center; text-transform: uppercase; border-bottom: 5px solid #ff4444; letter-spacing: 5px; }
        
        /* Слайд 2: Новини з прокруткою */
        .scroll-container { flex-grow: 1; overflow: hidden; position: relative; width: 100%; }
        .scroll-content { position: absolute; width: 100%; font-size: 2.5rem; line-height: 1.5; white-space: pre-wrap; animation: scrollUp 28s linear infinite; color: #ddd; }
        @keyframes scrollUp { from { top: 105%; } to { top: -150%; } }

        /* Слайд 3: Привітання */
        .holiday-title { color: #ffd700; border-color: #ffd700; }
        .bday-container { 
            flex-grow: 1; display: flex; justify-content: center; align-items: center; 
            padding: 40px; border: 10px double #ffd700; border-radius: 50px; background: rgba(255, 215, 0, 0.05); 
        }
        .bday-text { font-size: 3rem; line-height: 1.3; text-align: center; font-weight: bold; color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        #clock { position: absolute; top: 15px; right: 25px; font-size: 2.2rem; z-index: 100; background: rgba(0,0,0,0.7); padding: 5px 20px; border-radius: 12px; font-family: monospace; }
    </style>
</head>
<body>

    <div id="clock">00:00</div>

    <div class="slide active" id="slide1">
        <iframe src="https://alerts.in.ua/"></iframe>
    </div>

    <div class="slide text-slide" id="slide2">
        <h1>НОВИНИ</h1>
        <div class="scroll-container">
            <div id="news-content" class="scroll-content">Завантаження новин...</div>
        </div>
    </div>

    <div class="slide text-slide" id="slide3">
        <h1 class="holiday-title">ВІТАННЯ</h1>
        <div class="bday-container">
            <div id="holiday-content" class="bday-text">Завантаження привітання...</div>
        </div>
    </div>

    <script>
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQEa4Dv6ZUnOjwEpd31r3LpfChJt2Eq6qenSjpq72x5L_Rdpl28ge7jyF_qi_p0p-CVbp7m7UIHSv24/pub?output=csv';

        async function updateData() {
            try {
                const response = await fetch(csvUrl);
                const data = await response.text();
                // Коректний розбір CSV з урахуванням лапок та переносів рядків
                const parts = data.match(/(".*?"|[^,]+)(?=\s*,|\s*$)/gs);
                
                if (parts) {
                    let news = parts[0].replace(/^"|"$/g, '').replace(/""/g, '"');
                    let holiday = parts[1] ? parts[1].replace(/^"|"$/g, '').replace(/""/g, '"') : "";
                    
                    document.getElementById('news-content').innerText = news;
                    document.getElementById('holiday-content').innerText = holiday;
                }
            } catch (e) { console.error("Помилка оновлення"); }
        }

        let current = 1;
        function changeSlide() {
            document.getElementById('slide' + current).classList.remove('active');
            current = current >= 3 ? 1 : current + 1;
            document.getElementById('slide' + current).classList.add('active');
            // Оновлюємо дані при кожному поверненні до карти, щоб ТБ завжди був актуальним
            if (current === 1) updateData();
        }

        setInterval(changeSlide, 30000); // 30 секунд на слайд
        updateData();

        setInterval(() => {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('uk-UA', {hour: '2-digit', minute:'2-digit'});
        }, 1000);
    </script>
</body>
</html>
